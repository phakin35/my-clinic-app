<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏≠‡∏≤‡πÄ‡πÄ‡∏á‡∏ß Clinic - ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÅ‡∏™‡∏ô‡∏™‡∏∏‡∏Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700;800&display=swap');

        body {
            font-family: 'Sarabun', sans-serif;
        }

        .hidden-section {
            display: none;
        }

        .hero-bg {
            background-image: url('https://image.springnews.co.th/uploads/images/contents/w1024/2023/02/v2lndUTOu19ngpbivyf6.webp');
            background-size: cover;
            background-position: center 20%;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }

        .glass-btn {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .glass-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        @keyframes blink {
            50% {
                opacity: 0.5;
            }
        }

        .animate-blink {
            animation: blink 2s infinite;
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-700 antialiased selection:bg-teal-100 selection:text-teal-900">

    <!-- Navbar -->
    <nav
        class="bg-white/90 backdrop-blur-md shadow-sm sticky top-0 z-50 border-b border-teal-50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <div class="flex items-center gap-3 cursor-pointer group" onclick="goHome()">
                    <div
                        class="bg-gradient-to-br from-teal-400 to-teal-600 p-2.5 rounded-2xl text-white shadow-lg shadow-teal-200 group-hover:scale-105 transition duration-300">
                        <i data-lucide="paw-print" class="w-6 h-6"></i>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-2xl font-extrabold tracking-tight leading-none text-slate-800">‡∏≠‡∏≤‡πÄ‡πÄ‡∏á‡∏ß
                            ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å</span>
                        <span class="text-xs font-bold tracking-widest text-orange-500 uppercase">Cat Dog Clinic</span>
                    </div>
                </div>

                <div class="hidden md:flex items-center gap-8">
                    <button onclick="goHome()"
                        class="text-gray-500 hover:text-teal-600 font-bold transition text-sm uppercase tracking-wide">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                    <!-- üì∫ ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≠‡∏Ñ‡∏¥‡∏ß -->
                    <button id="btn-queue-board" onclick="toggleQueueBoard()"
                        class="hidden text-white bg-slate-800 hover:bg-slate-700 font-bold px-3 py-1.5 rounded-lg items-center gap-2 text-sm shadow-md transition">
                        <i data-lucide="monitor" class="w-4 h-4"></i> ‡∏à‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏¥‡∏ß (TV)
                    </button>
                    <button onclick="showAuthModal('login', 'doctor')"
                        class="text-gray-400 hover:text-teal-600 font-medium flex items-center gap-1 transition text-sm">
                        <i data-lucide="shield-check" class="w-4 h-4"></i> ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
                    </button>
                    <div id="nav-user-info" class="hidden flex items-center gap-4 ml-2 pl-6 border-l border-gray-200">
                        <div class="text-right">
                            <div id="user-display-name" class="text-sm font-bold text-slate-800">User</div>
                            <div id="user-role-display"
                                class="text-xs font-semibold text-teal-600 bg-teal-50 px-2 py-0.5 rounded-full inline-block">
                                Customer</div>
                        </div>
                        <button onclick="logout()"
                            class="bg-slate-100 hover:bg-red-50 hover:text-red-500 p-2.5 rounded-full text-slate-400 transition shadow-sm">
                            <i data-lucide="log-out" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <div id="nav-auth-buttons" class="flex gap-3">
                        <button onclick="showAuthModal('login')"
                            class="px-5 py-2.5 text-slate-600 font-bold hover:bg-slate-100 rounded-full transition text-sm">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                        <button onclick="showAuthModal('register')"
                            class="px-6 py-2.5 bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold rounded-full shadow-lg shadow-orange-200 hover:shadow-orange-300 hover:-translate-y-0.5 transition flex items-center gap-2 text-sm">
                            <i data-lucide="calendar-plus" class="w-4 h-4"></i> ‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <!-- Landing Page -->
        <div id="landing-page" class="animate-fade-in">
            <header class="hero-bg h-[600px] relative flex items-center">
                <div class="absolute inset-0 bg-gradient-to-r from-slate-900/80 via-teal-900/40 to-transparent"></div>
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full relative z-10">
                    <div class="max-w-2xl space-y-6">
                        <div
                            class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/20 backdrop-blur-md border border-white/30 text-white text-sm font-semibold shadow-lg">
                            <span class="w-2 h-2 rounded-full bg-orange-400 animate-pulse"></span> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
                        </div>
                        <h1 class="text-5xl md:text-7xl font-extrabold text-white leading-tight drop-shadow-sm">
                            ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ã‡∏µ‡πâ‡∏™‡∏µ‡πà‡∏Ç‡∏≤ <br /> <span
                                class="text-transparent bg-clip-text bg-gradient-to-r from-teal-200 to-teal-400">‡πÄ‡∏£‡∏≤‡∏î‡∏π‡πÅ‡∏•‡∏î‡πâ‡∏ß‡∏¢‡πÉ‡∏à</span>
                        </h1>
                        <p class="text-lg md:text-xl text-slate-200 font-light max-w-lg leading-relaxed">
                            ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡∏°‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</p>
                        <div class="pt-6 flex flex-col sm:flex-row gap-4">
                            <button onclick="showAuthModal('register')"
                                class="bg-teal-500 hover:bg-teal-400 text-white text-lg font-bold py-4 px-10 rounded-full shadow-xl">‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</button>
                            <button onclick="scrollToSection('services')"
                                class="glass-btn text-lg font-bold py-4 px-10 rounded-full shadow-lg transition duration-300">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</button>
                        </div>
                    </div>
                </div>
            </header>
            <div
                class="bg-white/90 border-b border-gray-100 backdrop-blur-sm relative z-20 -mt-10 mx-4 md:mx-auto max-w-6xl rounded-2xl shadow-xl">
                <div class="px-4 py-8 grid grid-cols-2 md:grid-cols-4 gap-8 text-center divide-x divide-gray-100">
                    <div>
                        <div class="text-3xl font-extrabold text-teal-600">10+</div>
                        <div class="text-sm text-gray-500 font-medium">‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå</div>
                    </div>
                    <div>
                        <div class="text-3xl font-extrabold text-orange-500">24h</div>
                        <div class="text-sm text-gray-500 font-medium">‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</div>
                    </div>
                    <div>
                        <div class="text-3xl font-extrabold text-slate-700">5k+</div>
                        <div class="text-sm text-gray-500 font-medium">‡πÄ‡∏Ñ‡∏™‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏´‡∏≤‡∏¢</div>
                    </div>
                    <div>
                        <div class="text-3xl font-extrabold text-teal-600">4.9</div>
                        <div class="text-sm text-gray-500 font-medium">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                    </div>
                </div>
            </div>
            <!-- Services Section -->
            
            <section id="services" class="py-24 bg-slate-50 relative overflow-hidden">
            
                <!-- Decoration Bubbles -->
            
                <div
                    class="absolute top-20 right-0 w-80 h-80 bg-teal-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob">
                </div>
            
                <div
                    class="absolute bottom-20 left-0 w-80 h-80 bg-orange-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000">
                </div>
            
                <div
                    class="absolute top-1/2 left-1/2 w-80 h-80 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000">
                </div>
            
            
            
                <div class="max-w-7xl mx-auto px-4 relative z-10">
            
                    <div class="text-center mb-16 max-w-2xl mx-auto">
            
                        <span
                            class="text-orange-500 font-bold tracking-wider uppercase text-sm bg-orange-50 px-3 py-1 rounded-full">Services</span>
            
                        <h2 class="text-4xl font-extrabold text-slate-800 mt-4 mb-4">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏£‡∏±‡∏Å</h2>
            
                        <p class="text-slate-500 text-lg">‡πÄ‡∏£‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤
                            ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°</p>
            
                    </div>
            
            
            
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            
                        <div
                            class="glass-panel p-8 rounded-3xl shadow-sm hover:shadow-xl hover:shadow-teal-100/50 transition duration-300 group">
            
                            <div
                                class="w-16 h-16 bg-white text-teal-600 rounded-2xl flex items-center justify-center mb-6 shadow-sm group-hover:bg-teal-500 group-hover:text-white transition duration-300 group-hover:rotate-6">
            
                                <i data-lucide="stethoscope" class="w-8 h-8"></i>
            
                            </div>
            
                            <h3 class="text-2xl font-bold mb-3 text-slate-800">General Care</h3>
            
                            <p class="text-slate-600 leading-relaxed mb-6">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô
                                ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏´‡πá‡∏ö‡∏´‡∏°‡∏±‡∏î ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á</p>
            
                        </div>
            
                        <div
                            class="glass-panel p-8 rounded-3xl shadow-sm hover:shadow-xl hover:shadow-orange-100/50 transition duration-300 group">
            
                            <div
                                class="w-16 h-16 bg-white text-orange-500 rounded-2xl flex items-center justify-center mb-6 shadow-sm group-hover:bg-orange-500 group-hover:text-white transition duration-300 group-hover:-rotate-6">
            
                                <i data-lucide="heart-pulse" class="w-8 h-8"></i>
            
                            </div>
            
                            <h3 class="text-2xl font-bold mb-3 text-slate-800">Surgery & Dental</h3>
            
                            <p class="text-slate-600 leading-relaxed mb-6">‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏°‡∏¢‡∏≤‡∏™‡∏•‡∏ö‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
                                ‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏π‡∏î‡∏´‡∏¥‡∏ô‡∏õ‡∏π‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£</p>
            
                        </div>
            
                        <div
                            class="glass-panel p-8 rounded-3xl shadow-sm hover:shadow-xl hover:shadow-blue-100/50 transition duration-300 group">
            
                            <div
                                class="w-16 h-16 bg-white text-blue-500 rounded-2xl flex items-center justify-center mb-6 shadow-sm group-hover:bg-blue-500 group-hover:text-white transition duration-300 group-hover:rotate-6">
            
                                <i data-lucide="scissors" class="w-8 h-8"></i>
            
                            </div>
            
                            <h3 class="text-2xl font-bold mb-3 text-slate-800">Grooming & Spa</h3>
            
                            <p class="text-slate-600 leading-relaxed mb-6">‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥‡∏ï‡∏±‡∏î‡∏Ç‡∏ô‡πÇ‡∏î‡∏¢‡∏ä‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£
                                ‡πÉ‡∏ä‡πâ‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏≠‡∏≠‡∏£‡πå‡πÅ‡∏Å‡∏ô‡∏¥‡∏Å ‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô‡∏ï‡πà‡∏≠‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á</p>
            
                        </div>
            
                    </div>
            
                </div>
            
            </section>
        </div>

        <!-- 2. Application Screen -->
        <div id="app-screen" class="hidden-section max-w-7xl mx-auto p-4 md:p-8 min-h-screen">

            <!-- A. Customer View -->
            <section id="role-customer" class="hidden-section fade-in">
                <div class="flex flex-col lg:flex-row gap-8">
                    <div class="lg:w-1/3">
                        <div class="glass-panel p-6 rounded-2xl shadow-lg border-t-4 border-teal-500 sticky top-24">
                            <h2 class="text-2xl font-bold text-teal-800 mb-4 flex items-center gap-2"><i
                                    data-lucide="calendar-plus"></i> ‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏ï‡∏£‡∏ß‡∏à</h2>
                            <form onsubmit="handleBooking(event)" class="space-y-4">
                                <input type="text" id="cust-ownerName" name="ownerName" readonly
                                    class="w-full bg-slate-100 border-0 rounded-lg p-2.5 text-slate-500 text-sm cursor-not-allowed">
                                <div class="grid grid-cols-2 gap-3">
                                    <input name="petName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á"
                                        class="w-full border p-2 rounded-lg outline-none focus:ring-2 focus:ring-teal-500">
                                    <select name="petType"
                                        class="w-full border p-2 rounded-lg bg-white outline-none focus:ring-2 focus:ring-teal-500">
                                        <option value="dog">‡∏™‡∏∏‡∏ô‡∏±‡∏Ç</option>
                                        <option value="cat">‡πÅ‡∏°‡∏ß</option>
                                        <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                                    </select>
                                </div>
                                <div class="grid grid-cols-3 gap-2">
                                    <input name="breed" placeholder="‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå" class="border p-2 rounded-lg text-sm">
                                    <input name="weight" placeholder="‡∏ô‡∏ô." class="border p-2 rounded-lg text-sm">
                                    <input name="height" placeholder="‡∏™‡∏π‡∏á" class="border p-2 rounded-lg text-sm">
                                </div>
                                <div class="grid grid-cols-2 gap-2">
                                    <input type="date" name="date" required class="w-full border p-2 rounded-lg">
                                    <select name="timeSlot" required class="w-full border p-2 rounded-lg bg-white">
                                        <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤...</option>
                                        <option value="09:00-09:30">09:00</option>
                                        <option value="09:30-10:00">09:30</option>
                                        <option value="10:00-10:30">10:00</option>
                                        <option value="10:30-11:00">10:30</option>
                                        <option value="11:00-11:30">11:00</option>
                                        <option value="13:00-13:30">13:00</option>
                                        <option value="13:30-14:00">13:30</option>
                                        <option value="14:00-14:30">14:00</option>
                                        <option value="14:30-15:00">14:30</option>
                                    </select>
                                </div>
                                <textarea name="symptoms" placeholder="‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô" required
                                    class="w-full border p-2 rounded-lg outline-none focus:ring-2 focus:ring-teal-500"></textarea>
                                <input type="hidden" name="phone" value="-" />
                                <button type="submit"
                                    class="w-full bg-teal-600 text-white font-bold py-3 rounded-lg hover:bg-teal-700 shadow-lg">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button>
                            </form>
                        </div>
                    </div>
                    <div class="lg:w-2/3">
                        <h2 class="text-2xl font-bold text-slate-700 mb-4 flex items-center gap-2"><i
                                data-lucide="history" class="text-orange-500"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
                        <div id="customerHistory" class="space-y-3"></div>
                    </div>
                </div>
            </section>

            <!-- B. Reception View -->
            <section id="role-reception" class="hidden-section fade-in">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-3xl font-bold text-slate-800">‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö (Reception)</h2>
                        <p class="text-slate-500 mt-1">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏ß‡πÅ‡∏•‡∏∞‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</p>
                    </div>
                    <button onclick="document.getElementById('walkInModal').classList.remove('hidden')"
                        class="bg-indigo-600 text-white px-5 py-2 rounded-lg shadow hover:bg-indigo-700 flex items-center gap-2 transition"><i
                            data-lucide="plus"></i> ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô Walk-in</button>
                </div>

                <div class="grid grid-cols-4 gap-4 mb-6">
                    <div class="glass-panel p-4 rounded-3xl border-l-4 border-yellow-400">
                        <div class="text-xs text-yellow-600 font-bold uppercase">‡∏£‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô</div>
                        <div class="text-3xl font-extrabold text-slate-800" id="stat-pending">0</div>
                    </div>
                    <div class="glass-panel p-4 rounded-3xl border-l-4 border-teal-500">
                        <div class="text-xs text-teal-600 font-bold uppercase">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</div>
                        <div class="text-3xl font-extrabold text-slate-800" id="stat-waiting">0</div>
                    </div>
                    <div class="glass-panel p-4 rounded-3xl border-l-4 border-purple-500">
                        <div class="text-xs text-purple-600 font-bold uppercase">‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</div>
                        <div class="text-3xl font-extrabold text-slate-800" id="stat-pharmacy">0</div>
                    </div>
                    <div class="glass-panel p-4 rounded-3xl border-l-4 border-green-500">
                        <div class="text-xs text-green-600 font-bold uppercase">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
                        <div class="text-3xl font-extrabold text-slate-800" id="stat-completed">0</div>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="mb-6 relative">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <i data-lucide="search" class="text-slate-400 w-5 h-5"></i>
                    </div>
                    <input type="text" id="searchInput" onkeyup="loadAppointments()"
                        placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á, ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£..."
                        class="w-full bg-white border border-slate-200 rounded-2xl py-4 pl-12 pr-4 text-slate-600 shadow-sm focus:ring-2 focus:ring-indigo-500 outline-none transition text-lg">
                </div>

                <div class="bg-white rounded-3xl shadow-xl shadow-slate-100 border border-slate-100 overflow-hidden">
                    <table class="w-full text-left">
                        <thead class="bg-slate-50/80 border-b border-slate-100">
                            <tr>
                                <th class="p-5 font-bold text-slate-500 text-sm">‡∏Ñ‡∏¥‡∏ß (Queue)</th>
                                <th class="p-5 font-bold text-slate-500 text-sm">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th class="p-5 font-bold text-slate-500 text-sm">‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</th>
                                <th class="p-5 font-bold text-slate-500 text-sm">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</th>
                                <th class="p-5 font-bold text-slate-500 text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="p-5 font-bold text-slate-500 text-sm text-right">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="receptionTable" class="divide-y divide-slate-50"></tbody>
                    </table>
                </div>
            </section>

            <!-- C. Doctor View -->
            <section id="role-doctor" class="hidden-section fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-[80vh]">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏¥‡∏ß‡∏£‡∏≠ -->
                    <div class="bg-white rounded-2xl shadow border overflow-hidden flex flex-col">
                        <div class="p-4 bg-teal-50 border-b font-bold text-teal-800 flex items-center gap-2"><i
                                data-lucide="list"></i> ‡∏Ñ‡∏¥‡∏ß‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</div>
                        <div id="doctorList" class="divide-y overflow-y-auto flex-1"></div>
                    </div>

                    <!-- ‡∏´‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à (Exam Room) -->
                    <div class="lg:col-span-2 bg-white rounded-2xl shadow border flex flex-col relative">
                        <div id="no-exam"
                            class="absolute inset-0 flex flex-col items-center justify-center text-slate-400">
                            <i data-lucide="stethoscope" class="w-16 h-16 mb-2 opacity-50"></i>
                            <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à</p>
                        </div>
                        <div id="exam-room" class="hidden flex flex-col h-full">
                            <div class="p-6 border-b bg-blue-50 flex justify-between items-center">
                                <div>
                                    <h3 id="exam-title" class="text-xl font-bold text-blue-900">...</h3>
                                    <p class="text-sm text-slate-500" id="exam-subtitle">...</p>
                                </div>
                                <div class="text-right text-xs text-slate-500 bg-white p-2 rounded border">
                                    <div id="exam-details-mini"></div>
                                </div>
                            </div>
                            <div class="p-6 space-y-4 flex-1 overflow-y-auto">
                                <input type="hidden" id="exam-id">
                                <textarea id="doc-diagnosis"
                                    class="w-full border p-3 h-32 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    placeholder="‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢ (Diagnosis)"></textarea>
                                <textarea id="doc-prescription"
                                    class="w-full border p-3 h-32 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    placeholder="‡∏™‡∏±‡πà‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏¢‡∏≤ (Prescription)"></textarea>
                            </div>
                            <div class="p-4 border-t bg-gray-50 flex justify-end gap-2">
                                <button onclick="cancelExam()"
                                    class="px-4 py-2 text-slate-500 hover:bg-gray-200 rounded-lg">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                                <button onclick="submitExam()"
                                    class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold shadow hover:bg-blue-700">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡πà‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- üì∫ QUEUE BOARD (Full Screen) -->
    <div id="queueBoard" class="hidden fixed inset-0 z-[100] bg-slate-900 text-white flex flex-col">
        <div class="flex justify-between items-center p-6 border-b border-slate-700 bg-slate-800">
            <div class="flex items-center gap-4">
                <div class="bg-teal-500 p-2 rounded-lg"><i data-lucide="monitor" class="w-8 h-8"></i></div>
                <div>
                    <h1 class="text-3xl font-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h1>
                    <p class="text-slate-400">Queue Monitor</p>
                </div>
            </div>
            <button onclick="toggleQueueBoard()"
                class="text-slate-400 hover:text-white bg-slate-700 p-2 rounded-full"><i data-lucide="x"
                    class="w-6 h-6"></i></button>
        </div>
        <div class="flex-1 grid grid-cols-3 divide-x divide-slate-700">
            <div
                class="col-span-2 p-12 flex flex-col items-center justify-center bg-slate-900 relative overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-br from-indigo-900/20 to-teal-900/20"></div>
                <h2 class="text-4xl font-bold text-teal-400 mb-8 uppercase tracking-widest relative z-10">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à /
                    Calling</h2>
                <div id="board-current" class="text-center relative z-10 w-full">
                    <div class="text-slate-500 text-2xl">...</div>
                </div>
            </div>
            <div class="col-span-1 flex flex-col bg-slate-800/50">
                <div class="flex-1 p-6 border-b border-slate-700">
                    <h3 class="text-xl font-bold text-orange-400 mb-4 flex items-center gap-2"><i
                            data-lucide="clock"></i> ‡∏Ñ‡∏¥‡∏ß‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à (Waiting)</h3>
                    <div id="board-waiting" class="space-y-3"></div>
                </div>
                <div class="flex-1 p-6 bg-slate-800">
                    <h3 class="text-xl font-bold text-purple-400 mb-4 flex items-center gap-2"><i
                            data-lucide="pill"></i> ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏¢‡∏≤ (Pharmacy)</h3>
                    <div id="board-pharmacy" class="space-y-3"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="authModal"
        class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[60] p-4">
        <div class="bg-white rounded-2xl w-full max-w-md p-6 relative">
            <button onclick="document.getElementById('authModal').classList.add('hidden')"
                class="absolute top-4 right-4"><i data-lucide="x"></i></button>
            <h3 id="authModalTitle" class="text-xl font-bold mb-4">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
            <form id="loginForm" class="space-y-3">
                <input name="username" placeholder="Username" required class="w-full border p-3 rounded-lg">
                <input type="password" name="password" placeholder="Password" required
                    class="w-full border p-3 rounded-lg">
                <button type="submit" class="w-full bg-teal-600 text-white font-bold py-3 rounded-lg">Log In</button>
                <div class="text-center text-sm text-blue-600 cursor-pointer hover:underline"
                    onclick="toggleAuthMode('register')">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà</div>
            </form>
            <form id="registerForm" class="hidden-section space-y-3">
                <input name="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required class="w-full border p-3 rounded-lg">
                <input name="username" placeholder="‡∏ï‡∏±‡πâ‡∏á Username" required class="w-full border p-3 rounded-lg">
                <input type="password" name="password" placeholder="‡∏ï‡∏±‡πâ‡∏á Password" required
                    class="w-full border p-3 rounded-lg">
                <button type="submit"
                    class="w-full bg-orange-500 text-white font-bold py-3 rounded-lg">Register</button>
                <div class="text-center text-sm text-blue-600 cursor-pointer hover:underline"
                    onclick="toggleAuthMode('login')">‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß?</div>
            </form>
        </div>
    </div>

    <div id="paymentModal"
        class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4">
        <div class="bg-white rounded-2xl w-full max-w-md p-6 relative">
            <button onclick="closePaymentModal()" class="absolute top-4 right-4"><i data-lucide="x"></i></button>
            <h3 class="text-xl font-bold text-purple-800 mb-2">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
            <div class="bg-purple-50 p-4 rounded-lg mb-4 text-sm space-y-2">
                <p><strong>‡∏ú‡∏•‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> <span id="pay-diag">-</span></p>
                <p><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤:</strong> <span id="pay-rx">-</span></p>
            </div>
            <form onsubmit="submitPayment(event)" class="space-y-4"><input type="hidden" id="pay-id"><input
                    type="number" id="pay-price" required class="w-full border p-3 rounded-lg text-xl text-right"
                    placeholder="0.00"><button type="submit"
                    class="w-full bg-purple-600 text-white px-6 py-2 rounded-lg font-bold">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</button></form>
        </div>
    </div>

    <div id="detailsModal"
        class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[80] p-4">
        <div class="bg-white rounded-2xl w-full max-w-lg p-0 overflow-hidden relative">
            <div class="bg-teal-600 p-4 text-white flex justify-between">
                <h3 class="font-bold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h3><button
                    onclick="document.getElementById('detailsModal').classList.add('hidden')"><i
                        data-lucide="x"></i></button>
            </div>
            <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
                <div class="flex gap-4 border-b pb-4">
                    <div class="text-3xl bg-slate-100 w-16 h-16 rounded-full flex items-center justify-center"><span
                            id="det-queueNo" class="text-xl font-bold text-teal-700">Q---</span></div>
                    <div>
                        <h4 class="text-xl font-bold" id="det-petName">...</h4>
                        <p class="text-sm text-slate-500" id="det-petInfo">...</p>
                    </div>
                </div>
                <div class="grid grid-cols-2 text-sm">
                    <div><span class="text-slate-400 block">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</span><span id="det-owner">...</span></div>
                    <div><span class="text-slate-400 block">‡πÄ‡∏ß‡∏•‡∏≤</span><span id="det-date">...</span></div>
                </div>
                <div><span class="text-slate-400 text-xs block">‡∏≠‡∏≤‡∏Å‡∏≤‡∏£</span>
                    <p id="det-symptoms" class="text-sm">...</p>
                </div>
                <div class="bg-blue-50 p-3 rounded"><span class="text-blue-500 text-xs block">‡∏ú‡∏•‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢</span>
                    <p id="det-diagnosis" class="text-sm">-</p>
                </div>
                <div class="bg-green-50 p-3 rounded"><span class="text-green-600 text-xs block">‡∏¢‡∏≤</span>
                    <p id="det-prescription" class="text-sm">-</p>
                </div>
                <div class="text-right pt-2"><span class="text-2xl font-bold text-teal-600" id="det-price">0</span> THB
                </div>
            </div>
        </div>
    </div>

    <div id="walkInModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-[70] p-4">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md relative">
            <button onclick="document.getElementById('walkInModal').classList.add('hidden')"
                class="absolute top-4 right-4"><i data-lucide="x"></i></button>
            <h3 class="text-xl font-bold mb-4">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô Walk-in</h3>
            <form onsubmit="handleWalkIn(event)" class="space-y-3">
                <input name="ownerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á" required class="w-full border p-2 rounded-lg">
                <div class="flex gap-2"><input name="petName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á" required
                        class="w-full border p-2 rounded-lg"><select name="petType" class="border p-2 rounded-lg">
                        <option value="dog">‡∏™‡∏∏‡∏ô‡∏±‡∏Ç</option>
                        <option value="cat">‡πÅ‡∏°‡∏ß</option>
                    </select></div>
                <div class="grid grid-cols-3 gap-2"><input name="breed" placeholder="‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå"
                        class="border p-2 rounded"><input name="weight" placeholder="‡∏ô‡∏ô."
                        class="border p-2 rounded"><input name="height" placeholder="‡∏™‡∏π‡∏á" class="border p-2 rounded">
                </div>
                <textarea name="symptoms" placeholder="‡∏≠‡∏≤‡∏Å‡∏≤‡∏£" required class="w-full border p-2 rounded-lg"></textarea>
                <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-2 rounded-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-300 py-12 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <div class="flex items-center gap-2 mb-4">
                        <div class="bg-teal-600 p-1.5 rounded-lg text-white"><i data-lucide="paw-print"
                                class="w-5 h-5"></i></div>
                        <span class="text-xl font-extrabold text-white tracking-tight">‡∏≠‡∏≤‡πÄ‡πÄ‡∏á‡∏ß Clinic</span>
                    </div>
                    <p class="text-sm text-slate-400 leading-relaxed">‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏¢‡πà‡∏≤‡∏ô‡∏ô‡∏µ‡πâ
                        ‡πÄ‡∏£‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ã‡∏µ‡πâ‡∏™‡∏µ‡πà‡∏Ç‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</p>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4 uppercase text-sm tracking-wider">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" onclick="goHome()" class="hover:text-teal-400 transition">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                        <li><a href="#" onclick="scrollToSection('services')"
                                class="hover:text-teal-400 transition">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</a></li>
                        <li><a href="#" onclick="showAuthModal('login')"
                                class="hover:text-teal-400 transition">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4 uppercase text-sm tracking-wider">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h4>
                    <ul class="space-y-2 text-sm">
                        <li class="flex items-start gap-2"><i data-lucide="map-pin"
                                class="w-4 h-4 mt-1 text-teal-500"></i><span>123 ‡∏ñ.‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡πÄ‡∏Ç‡∏ï‡∏ß‡∏±‡∏í‡∏ô‡∏≤<br>‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£
                                10110</span></li>
                        <li class="flex items-center gap-2"><i data-lucide="phone"
                                class="w-4 h-4 text-teal-500"></i><span>02-123-4567</span></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4 uppercase text-sm tracking-wider">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£</h4>
                    <div class="flex gap-4"><a href="#"
                            class="bg-slate-800 p-2 rounded-full hover:bg-teal-600 hover:text-white transition"><i
                                data-lucide="facebook" class="w-5 h-5"></i></a><a href="#"
                            class="bg-slate-800 p-2 rounded-full hover:bg-pink-500 hover:text-white transition"><i
                                data-lucide="instagram" class="w-5 h-5"></i></a></div>
                </div>
            </div>
            <div class="border-t border-slate-800 pt-8 text-center text-sm text-slate-500">&copy; 2025 Ah-Ngaew Clinic.
                All rights reserved.</div>
        </div>
    </footer>

    <script>
        lucide.createIcons();
        const API_URL = '/api';

        // --- AUTH ---
        function goHome() {
            if (localStorage.getItem('token')) {
                document.getElementById('landing-page').classList.remove('hidden-section');
                document.getElementById('app-screen').classList.add('hidden-section');
            } else location.reload();
        }
        function showAuthModal(mode) { document.getElementById('authModal').classList.remove('hidden'); toggleAuthMode(mode); }
        function toggleAuthMode(mode) {
            document.getElementById('loginForm').style.display = mode === 'login' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = mode === 'register' ? 'block' : 'none';
            document.getElementById('authModalTitle').innerText = mode === 'login' ? '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö' : '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å';
        }
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const res = await fetch(`${API_URL}/auth/login`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(Object.fromEntries(new FormData(e.target))) });
            const data = await res.json();
            if (res.ok) { localStorage.setItem('token', data.token); localStorage.setItem('role', data.role); localStorage.setItem('name', data.name); document.getElementById('authModal').classList.add('hidden'); checkAuth(); } else alert(data.error);
        });
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const res = await fetch(`${API_URL}/auth/register`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(Object.fromEntries(new FormData(e.target))) });
            if (res.ok) { alert('‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); toggleAuthMode('login'); } else alert('Error');
        });
        function logout() { localStorage.clear(); location.reload(); }

        function checkAuth() {
            const token = localStorage.getItem('token');
            const role = localStorage.getItem('role');
            const name = localStorage.getItem('name');
            if (!token) {
                document.getElementById('nav-user-info').classList.add('hidden');
                document.getElementById('nav-auth-buttons').classList.remove('hidden');
                return;
            }
            document.getElementById('nav-user-info').classList.remove('hidden');
            document.getElementById('nav-user-info').style.display = 'flex';
            document.getElementById('nav-auth-buttons').classList.add('hidden');
            document.getElementById('user-display-name').innerText = name;
            document.getElementById('user-role-display').innerText = role;
            document.getElementById('landing-page').classList.add('hidden-section');
            document.getElementById('app-screen').classList.remove('hidden-section');
            ['customer', 'reception', 'doctor'].forEach(r => document.getElementById(`role-${r}`).classList.add('hidden-section'));
            document.getElementById(`role-${role}`).classList.remove('hidden-section');

            // üåü Logic ‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏≠‡∏Ñ‡∏¥‡∏ß (Reception Only)
            if (role === 'reception') {
                document.getElementById('btn-queue-board').classList.remove('hidden');
                document.getElementById('btn-queue-board').classList.add('flex');
            } else {
                document.getElementById('btn-queue-board').classList.add('hidden');
                document.getElementById('btn-queue-board').classList.remove('flex');
            }

            if (role === 'customer') { document.getElementById('cust-ownerName').value = name; loadCustomerHistory(); } else { loadAppointments(); }
        }

        async function apiCall(endpoint, method = 'GET', body = null) {
            const token = localStorage.getItem('token');
            const opts = { method, headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' } };
            if (body) opts.body = JSON.stringify(body);
            const res = await fetch(`${API_URL}${endpoint}`, opts);
            if (res.status === 401 || res.status === 403) { logout(); return null; }
            return res.json();
        }

        // --- CUSTOMER ---
        async function handleBooking(e) {
            e.preventDefault();
            await apiCall('/appointments', 'POST', Object.fromEntries(new FormData(e.target)));
            alert('‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!'); e.target.reset(); document.getElementById('cust-ownerName').value = localStorage.getItem('name'); loadCustomerHistory();
        }
        async function loadCustomerHistory() {
            const data = await apiCall('/appointments');
            const myName = localStorage.getItem('name');
            const container = document.getElementById('customerHistory');
            container.innerHTML = '';
            if (!data) return;
            const myApps = data.filter(d => d.ownerName === myName).sort((a, b) => new Date(b.appointmentDate) - new Date(a.appointmentDate));
            myApps.forEach(app => {
                const appJson = JSON.stringify(app).replace(/"/g, '&quot;');
                // Create Queue Number
                const qNo = 'Q' + String(app.id).padStart(3, '0');
                container.innerHTML += `
                    <div onclick="openDetails(${appJson})" class="glass-panel p-4 rounded-xl cursor-pointer hover:bg-white transition flex justify-between items-center border border-transparent hover:border-teal-200">
                        <div>
                            <div class="text-xs text-teal-600 font-bold mb-1">${qNo}</div>
                            <div class="font-bold text-slate-800">${app.petName} <span class="text-xs text-slate-400">(${app.breed || '-'})</span></div>
                            <div class="text-xs text-slate-500">${app.dateDisplay} @ ${app.timeDisplay}</div>
                        </div>
                        <span class="text-xs bg-slate-100 px-2 py-1 rounded font-bold uppercase text-slate-500">${app.status}</span>
                    </div>`;
            });
        }

        // --- STAFF & DOCTOR ---
        async function loadAppointments() {
            const data = await apiCall('/appointments');
            if (!data) return;

            // 1. Calculate Stats from ALL data
            const stats = { pending: 0, waiting: 0, pharmacy: 0, completed: 0 };
            data.forEach(app => {
                if (stats[app.status] !== undefined) stats[app.status]++;
                if (app.status === 'in_consult') stats.waiting++;
            });

            // 2. Sort Logic (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ñ‡∏¥‡∏ß)
            data.sort((a, b) => {
                const statusOrder = { 'in_consult': 1, 'waiting': 2, 'pending': 3, 'pharmacy': 4, 'completed': 5 };
                const sA = statusOrder[a.status] || 99;
                const sB = statusOrder[b.status] || 99;
                if (sA !== sB) return sA - sB;

                const dateA = new Date(a.appointmentDate || a.createdAt);
                const dateB = new Date(b.appointmentDate || b.createdAt);
                const dayA = new Date(dateA.getFullYear(), dateA.getMonth(), dateA.getDate()).getTime();
                const dayB = new Date(dateB.getFullYear(), dateB.getMonth(), dateB.getDate()).getTime();
                if (dayA !== dayB) return dayA - dayB;

                const getTime = (item) => {
                    if (item.timeSlot) {
                        const [h, m] = item.timeSlot.split('-')[0].split(':');
                        return parseInt(h) * 60 + parseInt(m);
                    }
                    const d = new Date(item.appointmentDate || item.createdAt);
                    return d.getHours() * 60 + d.getMinutes();
                };
                const timeA = getTime(a);
                const timeB = getTime(b);
                if (timeA !== timeB) return timeA - timeB;

                if (a.timeSlot && !b.timeSlot) return -1;
                if (!a.timeSlot && b.timeSlot) return 1;

                return a.id - b.id;
            });

            renderQueueBoard(data);

            const searchTerm = document.getElementById('searchInput') ? document.getElementById('searchInput').value.toLowerCase() : '';
            const filteredData = data.filter(app => `${app.ownerName} ${app.petName} ${app.phone || ''}`.toLowerCase().includes(searchTerm));

            const tbody = document.getElementById('receptionTable');
            if (tbody) tbody.innerHTML = '';

            filteredData.forEach(app => {
                if (tbody) {
                    const appJson = JSON.stringify(app).replace(/"/g, '&quot;');
                    const qNo = 'Q' + String(app.id).padStart(3, '0'); // Generate Queue Number
                    let action = `<button onclick="openDetails(${appJson})" class="text-slate-400 text-xs hover:text-teal-600 font-bold border border-slate-200 px-2 py-1 rounded">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>`;
                    let statusBadge = '', statusLabel = '';

                    switch (app.status) {
                        case 'pending': statusBadge = 'bg-yellow-100 text-yellow-700 border-yellow-200'; statusLabel = '‡∏£‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô'; action = `<button onclick="updateStatus(${app.id}, 'waiting')" class="bg-teal-100 text-teal-700 font-bold hover:bg-teal-200 px-3 py-1 rounded text-sm transition">‚úî ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô</button>`; break;
                        case 'waiting': statusBadge = 'bg-blue-100 text-blue-700 border-blue-200'; statusLabel = '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à'; action = `<span class="text-xs text-slate-400 italic">‡∏£‡∏≠‡∏´‡∏°‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å...</span>`; break;
                        case 'in_consult': statusBadge = 'bg-indigo-100 text-indigo-700 border-indigo-200 animate-pulse'; statusLabel = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à'; action = `<span class="text-xs text-indigo-400 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤...</span>`; break;
                        case 'pharmacy': statusBadge = 'bg-purple-100 text-purple-700 border-purple-200'; statusLabel = '‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô'; action = `<button onclick="openPaymentModal(${app.id}, '${app.petName}', '${app.diagnosis?.replace(/'/g, "\\'")}', '${app.prescription?.replace(/'/g, "\\'")}')" class="bg-purple-600 text-white font-bold hover:bg-purple-700 px-3 py-1 rounded text-sm shadow-md transition">‡∏ø ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏á‡∏¥‡∏ô</button>`; break;
                        case 'completed': statusBadge = 'bg-green-100 text-green-700 border-green-200'; statusLabel = '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô'; break;
                        default: statusBadge = 'bg-gray-100 text-gray-500'; statusLabel = app.status;
                    }

                    const typeBadge = app.isWalkIn ? `<span class="bg-indigo-100 text-indigo-700 text-[10px] px-1.5 rounded ml-1 border border-indigo-200">Walk-in</span>` : `<span class="bg-teal-50 text-teal-600 text-[10px] px-1.5 rounded ml-1 border border-teal-200">Online</span>`;

                    tbody.innerHTML += `
                        <tr class="hover:bg-slate-50 border-b last:border-0 transition duration-150">
                            <td class="p-4 text-sm font-extrabold text-teal-700">${qNo}</td> <!-- Queue No Col -->
                            <td class="p-4 text-sm font-bold text-slate-700">${app.timeDisplay}<div class="mt-1">${typeBadge}</div></td>
                            <td class="p-4 font-bold text-slate-700 cursor-pointer hover:text-teal-600" onclick="openDetails(${appJson})">${app.petName} <span class="text-xs font-normal text-slate-400 bg-slate-100 px-1.5 py-0.5 rounded ml-1">(${app.petType})</span></td>
                            <td class="p-4 text-sm text-slate-500"><div class="flex flex-col"><span>${app.ownerName}</span><span class="text-xs text-slate-400">${app.breed || '-'} ${app.weight ? '/ ' + app.weight + 'kg' : ''}</span></div></td>
                            <td class="p-4"><span class="px-2.5 py-1 rounded-full text-xs font-bold border ${statusBadge}">${statusLabel}</span></td>
                            <td class="p-4 text-right space-x-2 flex justify-end items-center gap-2">${action}<button onclick="openDetails(${appJson})" class="text-slate-400 hover:text-teal-600 p-1 rounded-full hover:bg-slate-100 transition"><i data-lucide="info" class="w-4 h-4"></i></button></td>
                        </tr>`;
                }
            });

            if (document.getElementById('stat-pending')) {
                document.getElementById('stat-pending').innerText = stats.pending;
                document.getElementById('stat-waiting').innerText = stats.waiting;
                document.getElementById('stat-pharmacy').innerText = stats.pharmacy;
                document.getElementById('stat-completed').innerText = stats.completed;
            }

            const docList = document.getElementById('doctorList');
            if (docList) {
                docList.innerHTML = '';
                const patients = filteredData.filter(d => ['waiting', 'in_consult'].includes(d.status));
                if (patients.length === 0) docList.innerHTML = `<div class="p-8 text-center text-slate-400">‡∏ß‡πà‡∏≤‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏¥‡∏ß)</div>`;
                patients.forEach(p => {
                    const isActive = document.getElementById('exam-id').value == p.id;
                    const activeClass = isActive ? 'bg-teal-50 border-l-4 border-teal-500' : 'hover:bg-slate-50 border-l-4 border-transparent';
                    const qNo = 'Q' + String(p.id).padStart(3, '0');
                    const typeLabel = p.isWalkIn ? '<span class="text-[10px] bg-indigo-50 text-indigo-600 px-1 rounded border border-indigo-100">Walk-in</span>' : '<span class="text-[10px] bg-teal-50 text-teal-600 px-1 rounded border border-teal-100">Online</span>';

                    docList.innerHTML += `
                        <div onclick="startExam(${p.id}, '${p.petName}', '${p.ownerName}', '${p.breed || ''}', '${p.weight || ''}', '${qNo}')" class="p-4 cursor-pointer border-b transition ${activeClass}">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-bold text-lg text-slate-800">${qNo} - ${p.petName}</span>
                                <div class="text-right"><span class="text-xs bg-white border px-1.5 py-0.5 rounded text-slate-500 font-mono block mb-1">${p.timeDisplay}</span>${typeLabel}</div>
                            </div>
                            <div class="text-xs text-slate-500 mb-2">${p.breed || ''} (${p.weight || '-'}kg)</div>
                            <div class="text-xs text-red-500 bg-red-50 px-2 py-1 rounded inline-block truncate max-w-full">${p.symptoms}</div>
                        </div>`;
                });
            }
            lucide.createIcons();
        }

        // --- ACTIONS ---
        async function updateStatus(id, status, extra = {}) { await apiCall(`/appointments/${id}/status`, 'PUT', { status, ...extra }); loadAppointments(); }
        async function handleWalkIn(e) { e.preventDefault(); await apiCall('/appointments', 'POST', { ...Object.fromEntries(new FormData(e.target)), isWalkIn: true }); document.getElementById('walkInModal').classList.add('hidden'); loadAppointments(); }

        // --- PAYMENT & DETAILS ---
        function openPaymentModal(id, name, diag, rx) {
            document.getElementById('paymentModal').classList.remove('hidden'); document.getElementById('pay-id').value = id;
            document.getElementById('pay-subtitle').innerText = `‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢: ${name}`; document.getElementById('pay-diag').innerText = diag || '-'; document.getElementById('pay-rx').innerText = rx || '-'; document.getElementById('pay-price').value = '';
        }
        function closePaymentModal() { document.getElementById('paymentModal').classList.add('hidden'); }
        async function submitPayment(e) { e.preventDefault(); await updateStatus(document.getElementById('pay-id').value, 'completed', { price: document.getElementById('pay-price').value }); closePaymentModal(); }

        function openDetails(app) {
            document.getElementById('detailsModal').classList.remove('hidden');
            const qNo = 'Q' + String(app.id).padStart(3, '0');
            document.getElementById('det-queueNo').innerText = qNo;
            document.getElementById('det-petName').innerText = app.petName;
            document.getElementById('det-petInfo').innerText = `${app.petType} / ${app.breed || '-'} / ${app.weight || '-'}kg / ${app.height || '-'}cm`;
            document.getElementById('det-owner').innerText = app.ownerName;
            document.getElementById('det-date').innerText = `${app.dateDisplay} ${app.timeDisplay}`;
            document.getElementById('det-symptoms').innerText = app.symptoms;
            document.getElementById('det-diagnosis').innerText = app.diagnosis || '‡∏£‡∏≠‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à';
            document.getElementById('det-prescription').innerText = app.prescription || '-';
            document.getElementById('det-price').innerText = app.price || '0';
        }

        // --- DOCTOR FLOW ---
        function startExam(id, pet, owner, breed, weight, qNo) {
            updateStatus(id, 'in_consult');
            document.getElementById('no-exam').classList.add('hidden'); document.getElementById('exam-room').classList.remove('hidden');
            document.getElementById('exam-title').innerText = `${qNo} - ${pet}`;
            document.getElementById('exam-subtitle').innerText = owner;
            document.getElementById('exam-details-mini').innerText = `${breed}, ${weight}kg`; document.getElementById('exam-id').value = id;
            loadAppointments();
        }
        async function submitExam() { await updateStatus(document.getElementById('exam-id').value, 'pharmacy', { diagnosis: document.getElementById('doc-diagnosis').value, prescription: document.getElementById('doc-prescription').value }); cancelExam(); alert('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'); }
        function cancelExam() { document.getElementById('no-exam').classList.remove('hidden'); document.getElementById('exam-room').classList.add('hidden'); document.querySelectorAll('#exam-room textarea, #exam-room input').forEach(i => i.value = ''); loadAppointments(); }

        // --- QUEUE BOARD LOGIC ---
        function toggleQueueBoard() {
            const board = document.getElementById('queueBoard');
            if (board.classList.contains('hidden')) {
                board.classList.remove('hidden');
                if (document.documentElement.requestFullscreen) document.documentElement.requestFullscreen();
            } else {
                board.classList.add('hidden');
                if (document.exitFullscreen) document.exitFullscreen();
            }
        }

        function renderQueueBoard(data) {
            const current = data.find(d => d.status === 'in_consult');
            const waiting = data.filter(d => d.status === 'waiting');
            const pharmacy = data.filter(d => d.status === 'pharmacy');

            const currentEl = document.getElementById('board-current');
            if (current) {
                const qNo = 'Q' + String(current.id).padStart(3, '0');
                currentEl.innerHTML = `
                    <div class="animate-pulse">
                        <div class="text-6xl text-teal-300 font-bold mb-2">${qNo}</div>
                        <h1 class="text-7xl md:text-8xl font-extrabold text-white mb-4 drop-shadow-[0_0_15px_rgba(45,212,191,0.5)]">${current.petName}</h1>
                        <p class="text-3xl text-teal-200">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á: ${current.ownerName}</p>
                        <div class="mt-8 bg-teal-600 text-white text-2xl px-8 py-3 rounded-full inline-block font-bold shadow-lg">‡∏´‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à 1</div>
                    </div>`;
            } else {
                currentEl.innerHTML = `<div class="text-slate-600 text-4xl font-light">... ‡∏£‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏¥‡∏ß ...</div>`;
            }

            const waitingEl = document.getElementById('board-waiting');
            waitingEl.innerHTML = waiting.length ? '' : '<div class="text-slate-500 italic p-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏¥‡∏ß‡∏£‡∏≠</div>';
            waiting.forEach(w => {
                const qNo = 'Q' + String(w.id).padStart(3, '0');
                waitingEl.innerHTML += `
                    <div class="bg-slate-700 p-4 rounded-xl border-l-4 border-orange-500 flex justify-between items-center shadow-lg">
                        <div><div class="text-xl font-bold text-orange-300">${qNo}</div><div class="text-2xl font-bold text-white">${w.petName}</div></div>
                        <div class="text-xl font-mono text-slate-400">${w.timeDisplay}</div>
                    </div>`;
            });

            const pharmacyEl = document.getElementById('board-pharmacy');
            pharmacyEl.innerHTML = pharmacy.length ? '' : '<div class="text-slate-500 italic p-4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>';
            pharmacy.forEach(p => {
                const qNo = 'Q' + String(p.id).padStart(3, '0');
                pharmacyEl.innerHTML += `
                    <div class="bg-slate-700 p-4 rounded-xl border-l-4 border-purple-500 flex justify-between items-center shadow-lg">
                        <div><div class="text-lg font-bold text-purple-300">${qNo}</div><div class="text-xl font-bold text-white">${p.petName}</div></div>
                        <div class="text-purple-300 font-bold text-sm bg-purple-900/50 px-2 py-1 rounded">‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</div>
                    </div>`;
            });
        }

        checkAuth();
        setInterval(() => {
            const role = localStorage.getItem('role');
            if (role === 'reception' || role === 'doctor') loadAppointments();
            if (!document.getElementById('queueBoard').classList.contains('hidden')) loadAppointments();
        }, 5000);

    </script>
</body>

</html>